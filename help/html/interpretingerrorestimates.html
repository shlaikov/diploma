<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (top.location.search.lastIndexOf("toc=0")<=0) {
  if (top.frames.length==0) { top.location.href="index.html?interpretingerrorestimates.html"; }
  else { parent.lazysync('interpretingerrorestimates.html'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script>
   <title>Interpreting Error Estimates</title>
   <meta name="generator" content="Help & Manual">
   <meta name="keywords" content="Error,Error Estimates">
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <link type="text/css" href="styles.css" rel="stylesheet">
   <link type="text/css" href="custom.css" rel="stylesheet">
   <script type="text/javascript" src="nsh.js"></script>
   
<!-- non-scrolling headers for CHM and browser-based help, local styles-->
<style TYPE="text/css" media="screen"> 
   <!-- 
   body {    
      margin:0; 
      padding:0; 
      overflow: auto; 
      background: #FFFFFF; 
   } 
   #idheader { 
      width:100%; 
      height:auto; 
      padding: 0; 
      margin: 0; 
} 
    #idheaderbg  {
    background: #6F6F6F; 
}
   -->
   </style>
   
<style TYPE="text/css" MEDIA="print">
<!--
/* Hide navigation links and add space between header
     and text in the printed version. Not valid for eBooks. */
#idnav { display:none;	 }
.topichead { padding: 5px 5px 20px 5px; }
-->
</style>   
</head>
<body onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; filter:progid:DXImageTransform.Microsoft.DropShadow(color='b0b0b0', Direction=135, OffX='3', OffY='3') progid:DXImageTransform.Microsoft.Fade(Overlap=1.00);"></div>
<!--ZOOMSTOP-->

<div id="idheader">
<div id="idheaderbg">
<table width="100%" border="0" cellspacing="0" cellpadding="0" 
       style="margin: 0px; color: #6F6F6F; background: url(header_bg.jpg);">

  <tr valign="bottom">
    <td align="left" valign="bottom" class="topichead">
   <p class="crumbs" id="idnav"><b>Navigation:</b>&nbsp;
   
   Technical Notes&nbsp;&gt;</p>
   <p class="p_Heading1"><span class="f_Heading1">Interpreting Error Estimates</span></p>

    </td>
    <td align="right" width="120" valign="middle" class="topichead" id="idnav">
    <a href="javascript: print();"
    		onmouseover="document.images.prntr.src='print1.gif'" 
        onmouseout="document.images.prntr.src='print2.gif'"
        ><img name="prntr" border="0" alt="Print this Topic" title="Print this Topic" src="print2.gif"
        ></a>
     <a href="3dmeshgenerationinversion.html"
        onmouseover="document.images.prev.src='btn_prev_h.gif'" 
        onmouseout="document.images.prev.src='btn_prev_n.gif'"
        ><img name=prev src="btn_prev_n.gif" border=0 alt="Previous page"
        ></a><a href="flexpdehelp.html"
        onmouseover="document.images.main.src='btn_home_h.gif'" 
        onmouseout="document.images.main.src='btn_home_n.gif'"><img name=main src="btn_home_n.gif" border=0 alt="Return to chapter overview"
        ></a><a href="coordinatescaling.html"
        onmouseover="document.images.next.src='btn_next_h.gif'" 
        onmouseout="document.images.next.src='btn_next_n.gif'"><img name=next src="btn_next_n.gif" border=0 alt="Next page"
        ></a>
    </td>
  </tr>
  <tr><td colspan="2" style="height: 3px; background: url(header_bg_shadow.gif)"></td></tr>
</table>
</div>

<!-- The following code displays Expand All/Collapse All links  below the header in topics containing toggles -->
  

</div>  



<div id="idcontent"><div id="innerdiv"> 
<!--ZOOMRESTART-->
<p style="margin: 0px 0px 0px 0px;">FlexPDE uses estimates of the modeling error to control mesh refinement and timestep size. &nbsp;This note describes the methods used and the interpretation of the reports.</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;"><span style="font-weight: bold; text-decoration: underline;">Spatial Error</span></p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">The Galerkin Finite Element method uses integrals of the PDE's to form the discretized equations at the mesh nodes.  </p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">Each nodal equation requires that the weighted integral of the associated equation over the mesh cells surrounding the node be satisfied within a convergence tolerance. &nbsp;In FlexPDE this tolerance is taken to be a relative error of <span class="f_T_Code">(ERRLIM * OVERSHOOT)</span> in the norm of the solution vector.</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">In a regular hexagonal 2D mesh, for example, the Galerkin method requires that each hexagonal set of six triangular mesh cells must produce a weighted integral residual of zero.</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">This method at no point imposes any conditions on the integral over a single mesh cell, and conceivably on could have cancelling errors in adjacent cells.</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">In FlexPDE, we choose to use the individual cell integrals as a measure of the mesh quality. &nbsp;If the aggregate (eg 6-cell) integral is correct but the individual cells show large error, then the mesh must be refined.</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">The fundamental system which is solved by FlexPDE can be indicated as <span class="f_T_Code">R=G(U)=0</span>, where <span class="f_T_Code">R</span> is the residual and G(U) is the Galerkin integral of the PDE for variable <span class="f_T_Code">U</span>. &nbsp;If the residual over an individual cell is <span class="f_T_Code">R</span>, we can write <span class="f_T_Code">J*dU=R</span>, where <span class="f_T_Code">J</span> is the Jacobian matrix of derivatives of the Galerkin integral with respect to the nodal values, and <span class="f_T_Code">dU</span> is the error in <span class="f_T_Code">U</span> which produces the residual <span class="f_T_Code">R</span>.</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_T_Code">J</span> is of course the coupling matrix which is solved to produce the solution <span class="f_T_Code">U</span>. We don't want to completely repeat the solution process just to get an error estimate, so we use <span class="f_T_Code">D</span>, the diagonal components of <span class="f_T_Code">J</span>, to produce the error estimate <span class="f_T_Code">dU=Inv(D)*R</span>.  </p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">The &quot;RMS Error&quot; reported by FlexPDE in the Status Panel is just the root-mean-square average of <span class="f_T_Code">dU/range(U)</span> over the cells of the problem, while the reported &quot;MAX Error&quot; is the largest error <span class="f_T_Code">dU/range(U)</span> seen in any cell.</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">Mesh cells for which <span class="f_T_Code">dU/range(U) &gt; ERRLIM</span> are split in the mesh refinement pass.</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">Notice that the error measure is not a guarantee that the computed solution is &quot;accurate&quot; to within the stated error, that is, that the computed solution differs from the &quot;true&quot; solution by no more than the stated error. &nbsp;The error estimate is a local measure of how much variation of the solution would produce the computed error in the cell integral. &nbsp;Deviations from the &quot;true&quot; solution might accumulate over the domain of the problem, or they might cancel in neighboring regions.</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;"><span style="font-weight: bold; text-decoration: underline;">Temporal Error</span></p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">In time dependent problems, an estimate must also be formed of the error in integrating the equations in time.</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">FlexPDE integrates equations in time using a second-order implicit Backward Difference Formula (Gear method).</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">In order to measure temporal error, FlexPDE stores an additional timestep of values previous to the three points of the quadratic solution, and fits a cubic in time to the sequence at each node. &nbsp;The size of the cubic term implies the error in the quadratic solution, and is used to either increase or decrease the timestep in order to keep the RMS temporal error within the range specified by <span class="f_T_Code">ERRLIM</span>.</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">The three-point integration method requires an independent method to create data for the initial interval. &nbsp;FlexPDE uses a comparison of one-step and two-step trapezoidal rule integration to adapt the initial timestep to a range that produces acceptable error.</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">The temporal error estimate is not currently reported on the status panel.</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;"><span style="font-weight: bold; text-decoration: underline;">FlexPDE Error Controls</span></p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">There are several <span class="f_T_Code">SELECT</span> controls that can be used to alter the behavior of FlexPDE in regard to error measures.</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">The basic control is <span class="f_T_Code">ERRLIM</span>, which specifies the desired relative error in the solution variables, and controls both spatial and temporal measures. &nbsp;Smaller <span class="f_T_Code">ERRLIM</span> causes more mesh subdivision and smaller timesteps. &nbsp;Larger <span class="f_T_Code">ERRLIM</span> allows cruder meshes and, in principle, larger timesteps. &nbsp;However, a large <span class="f_T_Code">ERRLIM</span> can allow oscillations to develop, ultimately causing severe timestep cuts and a slower overall execution. &nbsp;It is rarely advisable to use an <span class="f_T_Code">ERRLIM</span> value <span style="font-style: italic;">larger</span> than the default <span class="f_T_Code">0.001</span>.</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_T_Code">XERRLIM</span> and <span class="f_T_Code">TERRLIM</span> are analogous to <span class="f_T_Code">ERRLIM</span>, but refer specifically to the spatial and temporal controls, allowing separate control of the two processes. If either of these controls is absent, it defaults to the value of <span class="f_T_Code">ERRLIM</span>.</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;">&nbsp;</p>

<!--ZOOMSTOP-->
<p>&nbsp;</p><hr size="1"><p class="fsmall">Page url: 
<a href="index.html?interpretingerrorestimates.html" target="_top">index.html?interpretingerrorestimates.html</a>
</p>
</div></div>
<script type="text/javascript"> 
<!-- 
var lastSlashPos = document.URL.lastIndexOf("/") >
document.URL.lastIndexOf("\\") ? document.URL.lastIndexOf("/") :
document.URL.lastIndexOf("\\");
if( document.URL.substring( lastSlashPos + 1, lastSlashPos + 4
).toLowerCase() != "~hh" )
{
    nsrInit();
}
--> 
</script> 
</body>
</html>
