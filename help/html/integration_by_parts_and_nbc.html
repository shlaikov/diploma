<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (top.location.search.lastIndexOf("toc=0")<=0) {
  if (top.frames.length==0) { top.location.href="index.html?integration_by_parts_and_nbc.html"; }
  else { parent.lazysync('integration_by_parts_and_nbc.html'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script>
   <title>Integration by Parts and Natural Boundary Conditions</title>
   <meta name="generator" content="Help & Manual">
   <meta name="keywords" content="Integration by Parts,NATURAL,NATURAL Boundary Condition,Integral Rules">
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <link type="text/css" href="styles.css" rel="stylesheet">
   <link type="text/css" href="custom.css" rel="stylesheet">
   <script type="text/javascript" src="nsh.js"></script>
   
<!-- non-scrolling headers for CHM and browser-based help, local styles-->
<style TYPE="text/css" media="screen"> 
   <!-- 
   body {    
      margin:0; 
      padding:0; 
      overflow: auto; 
      background: #FFFFFF; 
   } 
   #idheader { 
      width:100%; 
      height:auto; 
      padding: 0; 
      margin: 0; 
} 
    #idheaderbg  {
    background: #6F6F6F; 
}
   -->
   </style>
   
<style TYPE="text/css" MEDIA="print">
<!--
/* Hide navigation links and add space between header
     and text in the printed version. Not valid for eBooks. */
#idnav { display:none;	 }
.topichead { padding: 5px 5px 20px 5px; }
-->
</style>   
</head>
<body onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; filter:progid:DXImageTransform.Microsoft.DropShadow(color='b0b0b0', Direction=135, OffX='3', OffY='3') progid:DXImageTransform.Microsoft.Fade(Overlap=1.00);"></div>
<!--ZOOMSTOP-->

<div id="idheader">
<div id="idheaderbg">
<table width="100%" border="0" cellspacing="0" cellpadding="0" 
       style="margin: 0px; color: #6F6F6F; background: url(header_bg.jpg);">

  <tr valign="bottom">
    <td align="left" valign="bottom" class="topichead">
   <p class="crumbs" id="idnav"><b>Navigation:</b>&nbsp;
   
   Electromagnetic Applications &gt; <a href="em_introduction.html">Introduction</a>&nbsp;&gt;</p>
   <p class="p_Heading1"><span class="f_Heading1">Integration by Parts and Natural Boundary Conditions</span></p>

    </td>
    <td align="right" width="120" valign="middle" class="topichead" id="idnav">
    <a href="javascript: print();"
    		onmouseover="document.images.prntr.src='print1.gif'" 
        onmouseout="document.images.prntr.src='print2.gif'"
        ><img name="prntr" border="0" alt="Print this Topic" title="Print this Topic" src="print2.gif"
        ></a>
     <a href="boundary_conditions.html"
        onmouseover="document.images.prev.src='btn_prev_h.gif'" 
        onmouseout="document.images.prev.src='btn_prev_n.gif'"
        ><img name=prev src="btn_prev_n.gif" border=0 alt="Previous page"
        ></a><a href="em_introduction.html"
        onmouseover="document.images.main.src='btn_home_h.gif'" 
        onmouseout="document.images.main.src='btn_home_n.gif'"><img name=main src="btn_home_n.gif" border=0 alt="Return to chapter overview"
        ></a><a href="adaptive_mesh_refinement.html"
        onmouseover="document.images.next.src='btn_next_h.gif'" 
        onmouseout="document.images.next.src='btn_next_n.gif'"><img name=next src="btn_next_n.gif" border=0 alt="Next page"
        ></a>
    </td>
  </tr>
  <tr><td colspan="2" style="height: 3px; background: url(header_bg_shadow.gif)"></td></tr>
</table>
</div>

<!-- The following code displays Expand All/Collapse All links  below the header in topics containing toggles -->
  

</div>  



<div id="idcontent"><div id="innerdiv"> 
<!--ZOOMRESTART-->
<p>A fundamental technique applied by FlexPDE in treating the finite element equations is “integration by parts”, which reduces the order of a derivative integrand, and also leads immediately to a formulation of derivative boundary conditions for the PDE system.</p>
<p>In its usual form, integration by parts is given as</p>
<p><img src="image012.zoom33.png" width="183" height="47" border="0" alt="">.</p>
<p>Application of integration by parts to a vector divergence in a two- or three-dimensional domain, for example, results in the Divergence Theorem, given in 2D as </p>
<p><img src="image014.zoom33.png" width="162" height="34" border="0" alt="">.</p>
<p>This equation relates the integral inside the area to the flux crossing the outer boundary (<img src="image016.zoom33.png" width="14" height="19" border="0" alt="">referring to the outward surface-normal unit vector).</p>
<p>As we shall see, the use of integration by parts has a wide impact on the way FlexPDE interprets and solves PDE systems.</p>
<p>Applied to the weighted residual method, this process dictates the flux conservation characteristics of the finite element approximation at boundaries between the triangular approximation cells, and also provides a method for defining the interaction of the system with the outside world, by specifying the value of the surface integrand.</p>
<p>The values of the surface integrands are the “Natural” boundary conditions of the PDE system, a term which also arises in a similar context in variational calculus.</p>
<p>FlexPDE uses the term “Natural” boundary condition to specify the boundary flux terms arising from the integration by parts of all second-order terms in the PDE system.</p>
<p>For example, in a heat equation, <img src="image018.zoom33.png" width="125" height="27" border="0" alt="">, the divergence term will be integrated by parts, resulting in</p>
<p>(0.1) &nbsp; &nbsp; <img src="image020.zoom33.png" width="242" height="34" border="0" alt=""></p>
<p>The right hand side is the heat flux crossing the outer boundary, and the value of <img src="image022.zoom33.png" width="45" height="22" border="0" alt=""> must be provided by the user in a Natural boundary condition statement (unless a value BC is applied instead).</p>
<p>At an interface between two materials, <img src="image024.zoom33.png" width="86" height="27" border="0" alt=""> represents the heat energy leaving material 1 at a point on the interface. &nbsp;Likewise, <img src="image026.zoom33.png" width="92" height="27" border="0" alt=""> represents the heat energy leaving material 2 at the same point. &nbsp;Since the outward normal from material 1 is the negative of the outward normal from material 2, the sum of the fluxes at the boundary is <img src="image028.zoom33.png" width="165" height="30" border="0" alt="">, and this becomes the Natural boundary condition at the interface. &nbsp;In this application, we want energy to be conserved, so that the two flux terms must sum to zero. &nbsp;Thus the internal Natural BC is zero at the interface, and this is the default value applied by FlexPDE.</p>
<p>&nbsp;</p>
<p>Useful Integral Rules</p>
<p>(0.2) &nbsp; &nbsp; <img src="image030.zoom33.png" width="152" height="31" border="0" alt=""> &nbsp; &nbsp; (Gradient Theorem)</p>
<p>(0.3) &nbsp;  <img src="image032.zoom33.png" width="179" height="31" border="0" alt=""> &nbsp; (Divergence Theorem)</p>
<p>(0.4) &nbsp; &nbsp; <img src="image034.zoom33.png" width="320" height="31" border="0" alt=""></p>
<p>(0.5) &nbsp; &nbsp; <img src="image036.zoom33.png" width="194" height="31" border="0" alt=""> &nbsp;(Curl Theorem)</p>

<!--ZOOMSTOP-->
<p>&nbsp;</p><hr size="1"><p class="fsmall">Page url: 
<a href="index.html?integration_by_parts_and_nbc.html" target="_top">index.html?integration_by_parts_and_nbc.html</a>
</p>
</div></div>
<script type="text/javascript"> 
<!-- 
var lastSlashPos = document.URL.lastIndexOf("/") >
document.URL.lastIndexOf("\\") ? document.URL.lastIndexOf("/") :
document.URL.lastIndexOf("\\");
if( document.URL.substring( lastSlashPos + 1, lastSlashPos + 4
).toLowerCase() != "~hh" )
{
    nsrInit();
}
--> 
</script> 
</body>
</html>
