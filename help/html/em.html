<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (top.location.search.lastIndexOf("toc=0")<=0) {
  if (top.frames.length==0) { top.location.href="index.html?em.html"; }
  else { parent.lazysync('em.html'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script>
   <title>Applications in Electromagnetics</title>
   <meta name="generator" content="Help & Manual">
   <meta name="keywords" content="Electromagnetics,Electrostatics,Magnetostatics,Maxwell's Equations,Potential,Magnetic Vector Potential,VECTOR,VECTOR Potential">
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <link type="text/css" href="styles.css" rel="stylesheet">
   <link type="text/css" href="custom.css" rel="stylesheet">
   <script type="text/javascript" src="nsh.js"></script>
   
<!-- non-scrolling headers for CHM and browser-based help, local styles-->
<style TYPE="text/css" media="screen"> 
   <!-- 
   body {    
      margin:0; 
      padding:0; 
      overflow: auto; 
      background: #FFFFFF; 
   } 
   #idheader { 
      width:100%; 
      height:auto; 
      padding: 0; 
      margin: 0; 
} 
    #idheaderbg  {
    background: #6F6F6F; 
}
   -->
   </style>
   
<style TYPE="text/css" MEDIA="print">
<!--
/* Hide navigation links and add space between header
     and text in the printed version. Not valid for eBooks. */
#idnav { display:none;	 }
.topichead { padding: 5px 5px 20px 5px; }
-->
</style>   
</head>
<body onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; filter:progid:DXImageTransform.Microsoft.DropShadow(color='b0b0b0', Direction=135, OffX='3', OffY='3') progid:DXImageTransform.Microsoft.Fade(Overlap=1.00);"></div>
<!--ZOOMSTOP-->

<div id="idheader">
<div id="idheaderbg">
<table width="100%" border="0" cellspacing="0" cellpadding="0" 
       style="margin: 0px; color: #6F6F6F; background: url(header_bg.jpg);">

  <tr valign="bottom">
    <td align="left" valign="bottom" class="topichead">
   <p class="crumbs" id="idnav"><b>Navigation:</b>&nbsp;
   
   Technical Notes&nbsp;&gt;</p>
   <p class="p_Heading1"><span class="f_Heading1">Technical Notes | &nbsp; &nbsp; &nbsp; Applications in Electromagnetics</span></p>

    </td>
    <td align="right" width="120" valign="middle" class="topichead" id="idnav">
    <a href="javascript: print();"
    		onmouseover="document.images.prntr.src='print1.gif'" 
        onmouseout="document.images.prntr.src='print2.gif'"
        ><img name="prntr" border="0" alt="Print this Topic" title="Print this Topic" src="print2.gif"
        ></a>
     <a href="extrusion_spec.html"
        onmouseover="document.images.prev.src='btn_prev_h.gif'" 
        onmouseout="document.images.prev.src='btn_prev_n.gif'"
        ><img name=prev src="btn_prev_n.gif" border=0 alt="Previous page"
        ></a><a href="flexpdehelp.html"
        onmouseover="document.images.main.src='btn_home_h.gif'" 
        onmouseout="document.images.main.src='btn_home_n.gif'"><img name=main src="btn_home_n.gif" border=0 alt="Return to chapter overview"
        ></a><a href="smoothing.html"
        onmouseover="document.images.next.src='btn_next_h.gif'" 
        onmouseout="document.images.next.src='btn_next_n.gif'"><img name=next src="btn_next_n.gif" border=0 alt="Next page"
        ></a>
    </td>
  </tr>
  <tr><td colspan="2" style="height: 3px; background: url(header_bg_shadow.gif)"></td></tr>
</table>
</div>

<!-- The following code displays Expand All/Collapse All links  below the header in topics containing toggles -->
  

</div>  



<div id="idcontent"><div id="innerdiv"> 
<!--ZOOMRESTART-->
<p style="margin: 0px 0px 0px 0px;"><span style="font-family: 'Times New Roman'; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">I. &nbsp; &nbsp; &nbsp; &nbsp;Maxwell's Equations</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">The purpose of this note is to develop formulations for the application of FlexPDE to various problems in electromagnetics. &nbsp;It is not our intention to give a tutorial on electromagnetics; &nbsp;we assume that the reader has some familiarity with the subject, and has access to standard references.  </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">The starting point for our discussion is, as usual, Maxwell's equations. &nbsp;Posed in FlexPDE notation, these are</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(1) &nbsp; &nbsp; &nbsp; &nbsp;Curl(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">H</span><span style="color: #000000;">) = </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">J</span><span style="color: #000000;"> + dt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">D</span><span style="color: #000000;">)</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(2) &nbsp; &nbsp; &nbsp; &nbsp;Div(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">B</span><span style="color: #000000;">) = 0</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(3) &nbsp; &nbsp; &nbsp; &nbsp;Curl(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">E</span><span style="color: #000000;">) = -dt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">B</span><span style="color: #000000;">)</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(4) &nbsp; &nbsp; &nbsp; &nbsp;Div(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">D</span><span style="color: #000000;">) = p &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(p = charge density, &quot;rho&quot;)</span></p>
<p style="margin: 0px 0px 0px 0px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000000;"> </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;"> To these we add the constitutive relations</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(5) &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">D</span><span style="color: #000000;"> = e</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">E</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000000;">(e = permittivity, &quot;epsilon&quot;)</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(6) &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">B</span><span style="color: #000000;"> = m</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">H</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000000;">(m = permeability, &quot;mu&quot;)</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(7) &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">J</span><span style="color: #000000;"> = s</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">E</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000000;">(s = conductivity, &quot;sigma&quot;)</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(In isotropic materials, e, m and s are scalars, possibly nonlinear. &nbsp;In more complex materials, they may be tensors. In studies involving hysteresis or permanent magnets, modifications must be made to equation (6))</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">From these can be derived a convenient statement of charge conservation:</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(8) &nbsp; &nbsp; &nbsp; &nbsp;Div(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">J</span><span style="color: #000000;">) + dt(p) = 0</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">These equations form a very general framework for the study of electromagnetic fields, and admit of numerous combinations and permutations, depending on the characteristics of the problem at hand. &nbsp;Much confusion arises, in fact, from the tendency of textbooks to specialize the equations too soon, in order to simplify the exposition. &nbsp;This approach appears to present as a generally applicable formulation one which in reality embodies many assumptions about the problem being analyzed. We will discover that some alterations or substitutions that seem esthetically pleasing will not turn out to be wise computationally.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">II.   &nbsp; &nbsp; &nbsp; &nbsp;Choice of &nbsp;variables</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">A constraint due directly to the Finite Element model used in FlexPDE strikes us at the very outset. &nbsp;FlexPDE uses a continuous piecewise polynomial representation of all model variables. &nbsp;That is, at each computational node in the system it is assumed that each variable takes on a unique value, and that these nodal values can be connected in space by polynomial interpolations.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Application of the Divergence Theorem and Stokes' Theorem &nbsp;to Maxwell's equations yield the following boundary rules at material interfaces.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="60"><span style="color: #000000;">1)</span></td><td><span style="color: #000000;">The tangential component of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">E</span><span style="color: #000000;"> is continuous; the normal component of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">D</span><span style="color: #000000;">=(e</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">E</span><span style="color: #000000;">) is continuous (in the absence of surface charges).</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="60"><span style="color: #000000;">2)</span></td><td><span style="color: #000000;">The tangential component of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">H</span><span style="color: #000000;"> is continuous (in the absence of surface current); the normal component of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">B</span><span style="color: #000000;">=(m</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">H</span><span style="color: #000000;">) is continuous.</span></td></tr></table></div><p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">These rules are in general inconsistent with the model assumptions of FlexPDE. &nbsp;This means that the field components themselves cannot be chosen as the model variables unless one of the following conditions applies:</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">1) &nbsp; &nbsp; &nbsp; &nbsp;There are no material property discontinuities in the domain,</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">2) &nbsp; &nbsp; &nbsp; &nbsp;The discontinuous components of the field are absent in the specific configuration being modeled.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">For example, if we know that in a specific configuration that all the electric fields must be tangential to the material interfaces, we can use </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">E</span><span style="color: #000000;"> as a model variable. &nbsp;If we know instead that all the electric fields are normal to the material interfaces, we can use </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">D</span><span style="color: #000000;"> as a model variable.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">The analysis of fields in terms of the field components comprises the bulk of textbook treatments, and we will not pursue the topic further here. &nbsp; We will instead turn our attention to a more generally applicable modeling approach. &nbsp;Nevertheless, despite the seemingly restrictive nature of these prohibitions, there is a large class of problems which can be analyzed successfully by FlexPDE in terms of field components.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">III.  &nbsp; &nbsp; &nbsp; &nbsp;Potentials</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">For any twice-differentiable vector </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">v</span><span style="color: #000000;">, the vector identity Div(Curl(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">v</span><span style="color: #000000;">)) = 0 holds. &nbsp;This identity together with equation (2) implies that we can define a vector potential function </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">, the magnetic vector potential, such that</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(9) &nbsp; &nbsp; &nbsp; &nbsp;Curl(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) = </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">B</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">A theorem due to Helmholtz states that a vector field can be uniquely defined only by specifying both its curl and its divergence. &nbsp;We must remain aware, therefore, that at this point our vector potential is incompletely determined. &nbsp;The arbitrariness of Div(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) is frequently exploited to simplify the equations. &nbsp;In many cases, it is not necessary to explicitly specify Div(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">), allowing the boundary conditions and the artifacts of the computational model to define it by default.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Substituting relation (9) into equation (3) gives &nbsp;Curl(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">E</span><span style="color: #000000;"> + dt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) = 0. &nbsp;Another &nbsp;vector identity states that Curl(Grad(f))=0 for any twice differentiable scalar f. &nbsp;This allows us to define a scalar potential function V such that </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(10)</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="font-family: 'Arial'; font-weight: bold; color: #000000;">E</span><span style="color: #000000;"> = -Grad(V) - dt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">).</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">In the absence of time variation, V is seen to be the electrostatic potential.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Application of Faraday's Law to a pillbox on a material interface shows that V must be continuous across material interfaces. &nbsp;Application of Stokes' Theorem to </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> shows that the tangential component of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> must be continuous across material interfaces. &nbsp;All the conventional definitions of Div(A) also have the property that the normal component of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> is continuous across material interfaces. &nbsp;Therefore, formulations in terms of V and </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> completely satisfy the modeling assumptions of FlexPDE.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Since the two definitions (9) and (10) satisfy equations (2) and (3), we are left with &nbsp;Maxwell's equations (1) and (4), which &nbsp;in terms of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> and V are:</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(11) &nbsp; &nbsp; &nbsp; &nbsp;Curl(Curl(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)/m) + s dt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) + e dtt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) + s Grad(V) + e dt(Grad(V)) = 0</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(12) &nbsp; &nbsp; &nbsp; &nbsp;Div(e Grad(V)) + Div(e dt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) + p = 0</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">At this point, it is customary in the literature to apply vector identities to convert the Curl(Curl(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)/m) into a form containing Div(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">), so that a complete definition of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> can be achieved. &nbsp;In fact, these transformations require that m be continuous across material interfaces. &nbsp;We therefore defer this operation for discussion under the appropriate specializations to follow. &nbsp;We should also point out that in (11) we have substituted (7) </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">J</span><span style="color: #000000;"> = s</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">E</span><span style="color: #000000;">, a substitution we may later wish to rescind.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">IV. &nbsp; &nbsp; &nbsp; &nbsp;Boundary Conditions</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">FlexPDE uses the Divergence Theorem and its related Curl Theorem to reduce the order of second derivative terms, and assumes that the resulting surface integrals vanish at internal boundaries. &nbsp;Applied to (12), this process results in the continuity of the normal component of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">D</span><span style="color: #000000;">, as required by boundary rule 1). &nbsp;Applied to (11), this process results in the continuity of the tangential component of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">H</span><span style="color: #000000;">, as required by boundary rule 2).</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">At exterior boundaries, the Natural boundary condition specifies the value of the integrand of the surface integrals. &nbsp;For equation (11) this means the tangential component of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">H</span><span style="color: #000000;">, while for equation (12) it means the normal component of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">D</span><span style="color: #000000;">.  </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">1. &nbsp; &nbsp; &nbsp; &nbsp;Symmetry planes</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Following the above definition of the natural boundary condition, the specification &nbsp;&quot;NATURAL(V)=0&quot; for equation (12) means that the normal component of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">D</span><span style="color: #000000;"> is zero. This means that field lines must be parallel to the system boundary and that potential contours must be normal to the boundary. &nbsp;These are the conditions of a symmetry plane.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Similarly, if we specify &quot;NATURAL(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)=0&quot; for equation (11), we require that the tangential component of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">H </span><span style="color: #000000;">be zero. &nbsp;This says that field lines and potential contours must be normal to the boundary, which is again the condition of a symmetry plane.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">2. &nbsp; &nbsp; &nbsp; &nbsp;Perfect conductors</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Since a perfect conductor cannot sustain a field, the boundary condition &quot;VALUE(V)=constant&quot; for equation (12) defines a perfectly conducting boundary. &nbsp;Note that since equation (12) contains only derivatives of V, an arbitrary constant value may be added to the solution without affecting the equation. &nbsp;In order for a numerical solution to succeed, there must be some point in the domain at which a value condition is prescribed, in order to make the potential solution unique.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Similarly, the specification &quot;VALUE(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)=constant&quot; for equation (11) forces the normal component of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">H</span><span style="color: #000000;"> to be zero. &nbsp;As with V, a value should be ascribed to </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> somewhere in the domain, in order to make the potential solution unique.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">3. &nbsp; &nbsp; &nbsp; &nbsp;Distant Boundaries</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Ampere's Law states that the integral of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">H.dl </span><span style="color: #000000;">around a closed path is equal to the integral of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">J.dS</span><span style="color: #000000;"> over the enclosed surface, or just </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">I</span><span style="color: #000000;">, the enclosed current. &nbsp;Now, </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">H.dl</span><span style="color: #000000;"> is the tangential component of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">H</span><span style="color: #000000;">, which is exactly the quantity specified in equation (11) by the Natural boundary condition. &nbsp;In many cases, this fact can be used to construct meaningful terminating boundary conditions for otherwise open domains.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;"> The differential form of Ampere's Law can also be used to derive a general rule for the value of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A:</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">R</span><span style="color: #000000;">) = integral [</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">J</span><span style="color: #000000;">(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">R</span><span style="color: #000000;">')/|</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">R</span><span style="color: #000000;">-</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">R</span><span style="color: #000000;">'|] d</span><span style="font-size: 8px; font-family: 'Arial'; color: #000000;">3</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">R</span><span style="color: #000000;">'  </span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(In time-varying systems, </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">J</span><span style="color: #000000;"> must refer to a current retarded in time by the propagation time from </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">R</span><span style="color: #000000;">' to </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">R</span><span style="color: #000000;">.)</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">This form has the property that Div(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) = 0. &nbsp;We may add to this definition the gradient of an arbitrary scalar function G without affecting the resulting fields.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">At points distant from any currents we may write </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">R</span><span style="color: #000000;">) -&gt; </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">I</span><span style="color: #000000;">/|</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">R</span><span style="color: #000000;">|.</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Note that here </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">I</span><span style="color: #000000;"> is a vector which embodies the direction of the current, and that </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> has the direction of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">I</span><span style="color: #000000;">.</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">V. &nbsp; &nbsp; &nbsp; &nbsp;Harmonic Analysis</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Equations (11) and (12) describe a full time dependent model of the fields which can be extremely expensive to compute. &nbsp;In many cases of interest, the time dependence we desire to study is the stable oscillation caused by a sinusoidal excitation. &nbsp;In these cases it is convenient to make the assumption that each of the field components can be expressed in the complex form</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">P</span><span style="color: #000000;"> = </span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">P</span><span style="color: #000000;"> exp(iwt),</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Where </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">P</span><span style="color: #000000;"> is any of the field quantities, </span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">P</span><span style="color: #000000;"> is an associated complex amplitude (a function of space only),</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">w is the angular velocity, and i is the square root of minus 1. &nbsp;The observable field quantity is then the real part of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">P</span><span style="color: #000000;">, Re(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">P</span><span style="color: #000000;">).</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">With these assumptions, the time derivative terms in our equations reduce to simple forms:</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000000;">dt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">P</span><span style="color: #000000;">) = iw</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">P</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;">dtt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">P</span><span style="color: #000000;">) = -w</span><span style="font-size: 8px; font-family: 'Arial'; color: #000000;">2</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">P</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Applying these assumptions to equations (11) and (12) results in the harmonic equations</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(13) &nbsp; &nbsp; &nbsp; &nbsp;Curl(Curl(</span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)/m) + w(is-ew)</span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> + (s+iew)Grad(</span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">V</span><span style="color: #000000;">) = 0</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(14) &nbsp; &nbsp; &nbsp; &nbsp;Div(e Grad(</span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">V</span><span style="color: #000000;">)) + iw Div(e</span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) + </span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">p</span><span style="color: #000000;"> = 0</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">These equations require solution in space only, and are thus much more economical than the full time dependent system (11), (12). &nbsp;We will return to these equations frequently in the sections which follow.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">VI. &nbsp; &nbsp; &nbsp; &nbsp;Posing Equations for FlexPDE</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">We have been writing our equations in terms of vector fields, but in fact FlexPDE is not able to deal directly with vector fields; we must manually reduce the system to component equations. &nbsp;In a three dimensional space, equation (11) comprises three component equations while equation (12) is scalar. &nbsp;So we have a total of four equations in four unknowns, Ax, Ay, Az and V.  </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Equations (13)-(14) are more complicated, since each component has a real and an imaginary part, for a total of eight components. &nbsp;Each of these eight scalar variables must be represented by a separate component equation.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">We will not expand the equations into their final form just yet, because in most of the specializations addressed subsequently the resulting forms are not nearly so frightening as the full equations.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">VII. &nbsp; &nbsp; &nbsp; &nbsp;Specializations</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">In most problems of interest, the full generality of equations (11) and (12) or their harmonic equivalents (13) and (14) are not necessary. &nbsp;Analysis of the needs of the problem at hand can usually lead to considerable simplification. &nbsp;We will consider a few cases here.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">1. &nbsp; &nbsp; &nbsp; &nbsp;Electrostatics</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">For fields which are constant in time, equation (12) decouples from equation (11), and the electric scalar potential may be found from the single equation</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(15) &nbsp; &nbsp; &nbsp; &nbsp;Div(e Grad(V)) + p = 0</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Since FlexPDE applies the divergence theorem over each computational cell, inclusion of e inside the divergence is sufficient to guarantee the correct behavior of the field quantities across material interfaces. &nbsp;The natural boundary condition on V becomes a specification of the normal derivative of &nbsp;(e Grad(V)).</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Systems of this kind are addressed in the sample problems xxx.pde, etc.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">2. &nbsp; &nbsp; &nbsp; &nbsp;Magnetostatics</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">For fields which are constant in time, equation (11) becomes</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;">Curl(Curl(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)/m) + s Grad(V) = 0</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Here the term s Grad(V) is in fact a representation of the current density </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">J</span><span style="color: #000000;">, which we will probably wish to specify directly as the driving current for the fields:</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(16) &nbsp; &nbsp; &nbsp; &nbsp;Curl(Curl(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)/m) + </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">J</span><span style="color: #000000;"> = 0</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">In the geometric interpretation of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">, for which Div(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)=0, </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> has components parallel to the components of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">J</span><span style="color: #000000;">, so if </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">J</span><span style="color: #000000;"> is restricted to a single component, we may restrict </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> to only that component.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">As discussed in section IV, the Natural boundary condition for </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> specifies the tangential component of </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">H</span><span style="color: #000000;">. &nbsp;Natural(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)=0 specifies a symmetry plane, and Value(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)=0 specifies a perfect conductor.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Systems of this kind are addressed in the sample problems xxx.pde, etc.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">3. &nbsp; &nbsp; &nbsp; &nbsp;Non-magnetic Materials (constant m)</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">In the common case where m is constant, we can perform some simplification on equation (11). &nbsp;We can apply the vector identity</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;">Curl(Curl(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) = Grad(Div(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) - Div(Grad(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">))</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">To give</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(17) &nbsp; &nbsp; &nbsp; &nbsp;(1/m)Div(Grad(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) - s dt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) - e dtt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) = (1/m)Grad (Div(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) + s &nbsp;Grad(V) + e dt(Grad(V)).</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Since we now have an explicit Div(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">), we are in a position to define it in any way we choose to generate a form appropriate to our needs. &nbsp;The definition of Div(A) is commonly known as the &quot;Gauge Condition&quot;. &nbsp;The choice of gauge will be determined by what it is that we know about the problem at hand. &nbsp;Several common gauge conditions and the resulting forms of (11)-(12) are given below.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Note that this operation is not without consequences. &nbsp;The definition of the natural boundary condition has changed. &nbsp;It is no longer the boundary value of Curl(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)/m, but is now the boundary value of Grad(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)/m. &nbsp;Natural(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)=0 remains the condition for a symmetry plane, and Value(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)=0 still defines a perfect conductor boundary, but care must be taken if other values are assigned. &nbsp;In the case Div(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)=0, the two will be equivalent, in other choices of gauge they may not be.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Also note that because of typographical constraints we have written Div(Grad(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) for the component-wise Laplacian of the vector </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">. &nbsp;This notation is not strictly correct in curvilinear coordinates, and a more careful derivation must be made in those cases.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Without making further assumptions about e or s, we can apply the Coulomb gauge condition, </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;"> Div(A)=0 </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">With this assertion, equation (17) becomes </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(18) &nbsp; &nbsp; &nbsp; &nbsp;Div(Grad(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) - ms dt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) - me dtt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) = ms Grad(V) + me dt(Grad(V)) </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(19) &nbsp; &nbsp; &nbsp; &nbsp;Div(e Grad(V)) + Div(e dt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) + p = 0</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="font-size: 16px; font-family: 'Arial'; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Note that even though we have assumed Div(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)=0, we are not free to delete the Div(e dt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) from equation (18) unless e is also constant. &nbsp;Piecewise constancy of e is not sufficient, because Grad(e) is undefined at the interface and we have no way to apply a divergence theorem to convert it to a surface integral.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">4. &nbsp; &nbsp; &nbsp; &nbsp;Non-magnetic Materials with constant e</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">In the special case where both m and e are constant, the scalar potential equation (19) with Coulomb gauge can be simplified to</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(19') &nbsp; &nbsp; &nbsp; &nbsp;Div(Grad(V)) + p/e = 0.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Alternatively, we can use the &quot;Diffusion&quot; gauge condition:</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="font-size: 16px; font-family: 'Arial'; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;">Div(A) = -me dt(V) </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">We can reverse the order of differentiation &nbsp;and cause Div(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) to cancel the dt(Grad(V)) term in equation (11) and replace the dt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) term in equation (12).</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(20) &nbsp; &nbsp; &nbsp; &nbsp;Div(Grad(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) - ms dt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) - me dtt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) = ms Grad(V) </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(21) &nbsp; &nbsp; &nbsp; &nbsp;Div(Grad(V)) - me dtt(V) + p/e = 0</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">In some cases, s Grad(V) may be interpreted as the negative of the static current density, in which case the equations decouple and (20) may be eliminated.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">5. &nbsp; &nbsp; &nbsp; &nbsp;Non-magnetic Materials with constant e and s</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">In the special case where m, e and s are all constant, we can use the Lorentz gauge condition:</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="font-size: 16px; font-family: 'Arial'; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;">Div(A) = -msV - me dt(V) </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">This allows all the V terms to cancel from equation (17) resulting in decoupled equations for </span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> and V</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(22) &nbsp; &nbsp; &nbsp; &nbsp;Div(Grad(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) - ms dt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) - me dtt(</span><span style="font-family: 'Arial'; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) = 0</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(23) &nbsp; &nbsp; &nbsp; &nbsp;Div(Grad(V)) - ms dt(V) - me dtt(V) + p/e = 0</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">The equations have now been decoupled, and may be solved separately. &nbsp;These forms are useful in the solution of wave propagation problems.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">VIII. &nbsp; &nbsp; &nbsp; &nbsp;Specializations of the Harmonic Equations</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">1. &nbsp; &nbsp; &nbsp; &nbsp;Non-magnetic Materials </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Equations (13) and (14) can also be specialized to the case of constant m. &nbsp;The basic form of equation (13) is</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(24) &nbsp; &nbsp; &nbsp; &nbsp;(1/m)Div(Grad(</span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) + w(ew-is)</span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> = &nbsp;(1/m)Grad(Div(</span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) + (s + iwe) Grad(</span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">V</span><span style="color: #000000;"> ).</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Without making further assumptions about e or s we may apply the Coulomb gauge condition</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;"> Div(</span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)=0,</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">from which equations (13) and (14) become</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(25) &nbsp; &nbsp; &nbsp; &nbsp;Div(Grad(</span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) + mw(ew-is) </span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> &nbsp;= &nbsp;m(s+iew) Grad(</span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">V</span><span style="color: #000000;">) </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(26) &nbsp; &nbsp; &nbsp; &nbsp;Div(e Grad(</span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">V</span><span style="color: #000000;">)) + iw Div(e </span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) + </span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">p</span><span style="color: #000000;"> = 0</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="font-size: 16px; font-family: 'Arial'; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Note that even though we have assumed Div(</span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)=0, we are not free to delete the Div(e </span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) from equation (26) unless e is constant.  </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">2. &nbsp; &nbsp; &nbsp; &nbsp;Non-magnetic Materials with constant e</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">In the special case where both m and e are constant, equation (26) with Coulomb gauge can be simplified to</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(26') &nbsp; &nbsp; &nbsp; &nbsp;Div(Grad(</span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">V</span><span style="color: #000000;">)) + </span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">p</span><span style="color: #000000;">/e = 0.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="font-size: 16px; font-family: 'Arial'; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Alternatively, we can use the diffusion gauge condition </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;">Div(</span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) = -iwme </span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">V</span><span style="color: #000000;"> ,</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">from which we derive the equations</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(27) &nbsp; &nbsp; &nbsp; &nbsp;Div(Grad(</span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) + w(ew-is)</span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> &nbsp;= ms Grad(</span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">V</span><span style="color: #000000;">) </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(28) &nbsp; &nbsp; &nbsp; &nbsp;Div(Grad(</span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">V</span><span style="color: #000000;">)) + w</span><span style="font-size: 8px; font-family: 'Arial'; color: #000000;">2</span><span style="color: #000000;">me </span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">V</span><span style="color: #000000;"> + </span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">p</span><span style="color: #000000;">/e = 0</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">In some cases, s Grad(</span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">V</span><span style="color: #000000;">) may be interpreted as the negative of the conduction current density, in which case the equations decouple and (28) may be eliminated.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="font-size: 16px; font-family: 'Arial'; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span class="f_Heading3">3. &nbsp; &nbsp; &nbsp; &nbsp;Non-magnetic Materials with constant e and s</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">In the special case where m, e and s are all constant, we can use the Lorentz gauge condition,</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">which in the harmonic approximation becomes </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="color: #000000;">Div(</span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">) = -m(s+iew) </span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">V</span></p>
<p style="margin: 0px 0px 0px 60px;"><span style="font-family: 'Arial'; font-style: italic; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">All the V terms vanish in equation (24), and the pair (13), (14) become</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(29) &nbsp; &nbsp; &nbsp; &nbsp;Div(Grad(</span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;">)) + w(ew-is)</span><span style="font-family: 'Arial'; font-style: italic; font-weight: bold; color: #000000;">A</span><span style="color: #000000;"> &nbsp;= 0</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(30) &nbsp; &nbsp; &nbsp; &nbsp;Div(Grad(</span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">V</span><span style="color: #000000;">)) - m(s+iew)</span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">V</span><span style="color: #000000;"> + </span><span style="font-family: 'Arial'; font-style: italic; color: #000000;">p</span><span style="color: #000000;">/e = 0</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">The equations have now been decoupled, and may be solved separately. &nbsp;These forms are useful in the solution of wave propagation problems.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">(to be continued )</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>

<!--ZOOMSTOP-->
<p>&nbsp;</p><hr size="1"><p class="fsmall">Page url: 
<a href="index.html?em.html" target="_top">index.html?em.html</a>
</p>
</div></div>
<script type="text/javascript"> 
<!-- 
var lastSlashPos = document.URL.lastIndexOf("/") >
document.URL.lastIndexOf("\\") ? document.URL.lastIndexOf("/") :
document.URL.lastIndexOf("\\");
if( document.URL.substring( lastSlashPos + 1, lastSlashPos + 4
).toLowerCase() != "~hh" )
{
    nsrInit();
}
--> 
</script> 
</body>
</html>
