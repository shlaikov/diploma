<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (top.location.search.lastIndexOf("toc=0")<=0) {
  if (top.frames.length==0) { top.location.href="index.html?nonlinear.html"; }
  else { parent.lazysync('nonlinear.html'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script>
   <title>Solving Nonlinear Problems</title>
   <meta name="generator" content="Help & Manual">
   <meta name="keywords" content="NONLINEAR,NONLINEAR Problems,NEWTON,REMATRIX,PREFER_SPEED,PREFER_STABILITY">
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <link type="text/css" href="styles.css" rel="stylesheet">
   <link type="text/css" href="custom.css" rel="stylesheet">
   <script type="text/javascript" src="nsh.js"></script>
   
<!-- non-scrolling headers for CHM and browser-based help, local styles-->
<style TYPE="text/css" media="screen"> 
   <!-- 
   body {    
      margin:0; 
      padding:0; 
      overflow: auto; 
      background: #FFFFFF; 
   } 
   #idheader { 
      width:100%; 
      height:auto; 
      padding: 0; 
      margin: 0; 
} 
    #idheaderbg  {
    background: #6F6F6F; 
}
   -->
   </style>
   
<style TYPE="text/css" MEDIA="print">
<!--
/* Hide navigation links and add space between header
     and text in the printed version. Not valid for eBooks. */
#idnav { display:none;	 }
.topichead { padding: 5px 5px 20px 5px; }
-->
</style>   
</head>
<body onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; filter:progid:DXImageTransform.Microsoft.DropShadow(color='b0b0b0', Direction=135, OffX='3', OffY='3') progid:DXImageTransform.Microsoft.Fade(Overlap=1.00);"></div>
<!--ZOOMSTOP-->

<div id="idheader">
<div id="idheaderbg">
<table width="100%" border="0" cellspacing="0" cellpadding="0" 
       style="margin: 0px; color: #6F6F6F; background: url(header_bg.jpg);">

  <tr valign="bottom">
    <td align="left" valign="bottom" class="topichead">
   <p class="crumbs" id="idnav"><b>Navigation:</b>&nbsp;
   
   Technical Notes&nbsp;&gt;</p>
   <p class="p_Heading1"><span class="f_Heading1">Technical Notes | &nbsp; &nbsp; &nbsp; Solving Nonlinear Problems</span></p>

    </td>
    <td align="right" width="120" valign="middle" class="topichead" id="idnav">
    <a href="javascript: print();"
    		onmouseover="document.images.prntr.src='print1.gif'" 
        onmouseout="document.images.prntr.src='print2.gif'"
        ><img name="prntr" border="0" alt="Print this Topic" title="Print this Topic" src="print2.gif"
        ></a>
     <a href="natural.html"
        onmouseover="document.images.prev.src='btn_prev_h.gif'" 
        onmouseout="document.images.prev.src='btn_prev_n.gif'"
        ><img name=prev src="btn_prev_n.gif" border=0 alt="Previous page"
        ></a><a href="flexpdehelp.html"
        onmouseover="document.images.main.src='btn_home_h.gif'" 
        onmouseout="document.images.main.src='btn_home_n.gif'"><img name=main src="btn_home_n.gif" border=0 alt="Return to chapter overview"
        ></a><a href="eigen.html"
        onmouseover="document.images.next.src='btn_next_h.gif'" 
        onmouseout="document.images.next.src='btn_next_n.gif'"><img name=next src="btn_next_n.gif" border=0 alt="Next page"
        ></a>
    </td>
  </tr>
  <tr><td colspan="2" style="height: 3px; background: url(header_bg_shadow.gif)"></td></tr>
</table>
</div>

<!-- The following code displays Expand All/Collapse All links  below the header in topics containing toggles -->
  

</div>  



<div id="idcontent"><div id="innerdiv"> 
<!--ZOOMRESTART-->
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">FlexPDE automatically recognizes when a problem is nonlinear and modifies its strategy accordingly.  </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">In nonlinear systems, we are not guaranteed that the system will have a unique solution, and even if it does, we are not guaranteed that FlexPDE will be able to find it. &nbsp;The solution method used by FlexPDE is a modified Newton-Raphson iteration procedure. &nbsp;This is a &quot;descent&quot; method, which tries to fall down the gradient of an energy functional until minimum energy is achieved (i.e. the gradient of the functional goes to zero). If &nbsp;the functional is nearly quadratic, as it is in simple diffusion problems, then the method converges quadratically (the relative error is squared on each iteration). &nbsp;The default strategy implemented in FlexPDE is usually sufficient to determine a solution without user intervention. </span><br>
<span style="color: #000000;">&nbsp;</span></p>
<p class="p_Heading3"><span class="f_Heading3">Time-Dependent Problems</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">In nonlinear time-dependent problems, the default behavior is to compute the Jacobian matrix (the &quot;slope&quot; of the functional) and take a single Newton step at each timestep, on the assumption that any nonlinearities will be sensed by the timestep controller, and that timestep adjustments will guarantee an accurate evolution of the system from the given initial conditions.  </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Several selectors are provided to enable more robust (but more expensive) treatment in difficult cases. &nbsp;The &quot;NEWTON=number&quot; selector can be used to increase the maximum number of Newton iterations performed on each timestep. &nbsp;In this case, FlexPDE will examine the change in the system variables and recompute the Jacobian matrix whenever it seems warranted. &nbsp;The Selector REMATRIX=On will force the Jacobian matrix to be re-evaluated at each Newton step.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">The PREFER_SPEED &nbsp;selector is equivalent to the default behavior, setting NEWTON=1 and REMATRIX=Off.</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">The PREFER_STABILITY selector &nbsp;resets the values of &nbsp;NEWTON=5 and REMATRIX=On.  </span><br>
<span style="color: #000000;">&nbsp;</span></p>
<p class="p_Heading3"><span class="f_Heading3">Steady-State Problems</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">In the case of nonlinear steady-state problems, the situation is somewhat more complicated. &nbsp; The default controls are usually sufficient to achieve a solution. &nbsp;The Newton iteration is allowed to run a large number of iterations, and the Jacobian matrix is recomputed whenever the change in the solution values seem to warrant it. &nbsp;The Selector REMATRIX=On may be used to force re-computation of the Jacobian matirx on each Newton step.  </span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">In cases of strong nonlinearities, it may be necessary for the user to help guide FlexPDE to a valid solution. &nbsp;There are several techniques that can be used to help the solution process.</span></p>
<p class="p_Heading4"><span class="f_Heading4">Start with a Good Initial Value</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Providing an initial value which is near the correct solution will aid enormously in finding a solution. &nbsp;Be particularly careful that the initial value matches the boundary conditions. &nbsp;If it does not, serious excursions may be excited in the trial solution, leading to solution difficulties.</span></p>
<p class="p_Heading4"><span class="f_Heading4">Use STAGES to Gradually Activate the Nonlinear Terms</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">You can use the staging facility of FlexPDE to gradually increase the strength of the nonlinear terms. &nbsp;Start with a linear (or nearly linear) system, and allow FlexPDE to find a solution which is consistent with the boundary conditions. &nbsp;Then use this solution as a starting point for a more strongly nonlinear system. &nbsp;By judicious use of staging, you can creep up on a solution to very nasty problems.</span></p>
<p class="p_Heading4"><span class="f_Heading4">Use CHANGELIM to Control Modifications</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">The selector </span><span class="f_T_Code">CHANGELIM</span><span style="color: #000000;"> limits the amount by which any nodal value in a problem may be modified on each Newton-Raphson step. &nbsp;As in a one-dimensional Newton iteration, if the trial solution is near a local maximum of the functional, then shooting down the gradient will try to step an enormous distance to the next trial solution. &nbsp;FlexPDE limits the size of each nodal change to be less than </span><span class="f_T_Code">CHANGELIM</span><span style="color: #000000;"> times the average value of the variable. &nbsp;The default value for </span><span class="f_T_Code">CHANGELIM</span><span style="color: #000000;"> is </span><span class="f_T_Code">0.5</span><span style="color: #000000;">, but if the initial value (or any intermediate trial solution) is sufficiently far from the true solution, this value may allow wild excursions from which FlexPDE is unable to recover. &nbsp;Try cutting </span><span class="f_T_Code">CHANGELIM</span><span style="color: #000000;"> to </span><span class="f_T_Code">0.1</span><span style="color: #000000;">, or in severe cases even </span><span class="f_T_Code">0.01</span><span style="color: #000000;">, to force FlexPDE to creep toward a valid solution. &nbsp;In combination with a reasonable initial value, even </span><span class="f_T_Code">CHANGELIM=0.01</span><span style="color: #000000;"> can converge in a surprisingly short time. &nbsp;Since </span><span class="f_T_Code">CHANGELIM</span><span style="color: #000000;"> multiplies the RMS average value, not each local value, its effect disappears when a solution is reached, and quadratic final convergence is still achieved.</span></p>
<p class="p_Heading4"><span class="f_Heading4">Watch Out for Negative Values</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">FlexPDE uses piecewise polynomials to approximate the solution. &nbsp;In cases of rapid variation of the solution over a single cell, you will almost certainly see severe under-shoot in early stages. &nbsp;If you are assuming that the value of your variable will remain positive, don't. &nbsp;If your equations lose validity in the presence of negative values, perhaps you should recast the equations in terms of the logarithm of the variable. &nbsp;In this case, even though the logarithm may go negative, the implied value of your actual variable will remain positive.</span></p>
<p class="p_Heading4"><span class="f_Heading4">Recast the Problem in a Time-Dependent Form</span></p>
<p style="margin: 0px 0px 0px 0px;"><span style="color: #000000;">Any steady-state problem can be viewed as the infinite-time limit of a time-dependent problem. &nbsp;Rewrite your PDE's to have a time derivative term which will push the value in the direction of decreasing deviation from solution of the steady-state PDE. &nbsp;(A good model to follow is the time-dependent diffusion equation </span><span class="f_T_Code">DIV(K*GRAD(U)) = DT(U)</span><span style="color: #000000;">. &nbsp;A negative value of the divergence indicates a local maximum in the solution, and results in driving the value downward.) &nbsp;In this case, &quot;time&quot; is a fictitious variable analogous to the &quot;iteration count&quot; in the steady-state N-R iteration, but the time-dependent formulation allows the timestep controller to guide the evolution of the solution.</span></p>

<!--ZOOMSTOP-->
<p>&nbsp;</p><hr size="1"><p class="fsmall">Page url: 
<a href="index.html?nonlinear.html" target="_top">index.html?nonlinear.html</a>
</p>
</div></div>
<script type="text/javascript"> 
<!-- 
var lastSlashPos = document.URL.lastIndexOf("/") >
document.URL.lastIndexOf("\\") ? document.URL.lastIndexOf("/") :
document.URL.lastIndexOf("\\");
if( document.URL.substring( lastSlashPos + 1, lastSlashPos + 4
).toLowerCase() != "~hh" )
{
    nsrInit();
}
--> 
</script> 
</body>
</html>
